<html>
    <head>
        <meta charset="utf-8">
        
            <script>function neighbourhoodHighlight(params) {
  // console.log("in nieghbourhoodhighlight");
  allNodes = nodes.get({ returnType: "Object" });
  // originalNodes = JSON.parse(JSON.stringify(allNodes));
  // if something is selected:
  if (params.nodes.length > 0) {
    highlightActive = true;
    var i, j;
    var selectedNode = params.nodes[0];
    var degrees = 2;

    // mark all nodes as hard to read.
    for (let nodeId in allNodes) {
      // nodeColors[nodeId] = allNodes[nodeId].color;
      allNodes[nodeId].color = "rgba(200,200,200,0.5)";
      if (allNodes[nodeId].hiddenLabel === undefined) {
        allNodes[nodeId].hiddenLabel = allNodes[nodeId].label;
        allNodes[nodeId].label = undefined;
      }
    }
    var connectedNodes = network.getConnectedNodes(selectedNode);
    var allConnectedNodes = [];

    // get the second degree nodes
    for (i = 1; i < degrees; i++) {
      for (j = 0; j < connectedNodes.length; j++) {
        allConnectedNodes = allConnectedNodes.concat(
          network.getConnectedNodes(connectedNodes[j])
        );
      }
    }

    // all second degree nodes get a different color and their label back
    for (i = 0; i < allConnectedNodes.length; i++) {
      // allNodes[allConnectedNodes[i]].color = "pink";
      allNodes[allConnectedNodes[i]].color = "rgba(150,150,150,0.75)";
      if (allNodes[allConnectedNodes[i]].hiddenLabel !== undefined) {
        allNodes[allConnectedNodes[i]].label =
          allNodes[allConnectedNodes[i]].hiddenLabel;
        allNodes[allConnectedNodes[i]].hiddenLabel = undefined;
      }
    }

    // all first degree nodes get their own color and their label back
    for (i = 0; i < connectedNodes.length; i++) {
      // allNodes[connectedNodes[i]].color = undefined;
      allNodes[connectedNodes[i]].color = nodeColors[connectedNodes[i]];
      if (allNodes[connectedNodes[i]].hiddenLabel !== undefined) {
        allNodes[connectedNodes[i]].label =
          allNodes[connectedNodes[i]].hiddenLabel;
        allNodes[connectedNodes[i]].hiddenLabel = undefined;
      }
    }

    // the main node gets its own color and its label back.
    // allNodes[selectedNode].color = undefined;
    allNodes[selectedNode].color = nodeColors[selectedNode];
    if (allNodes[selectedNode].hiddenLabel !== undefined) {
      allNodes[selectedNode].label = allNodes[selectedNode].hiddenLabel;
      allNodes[selectedNode].hiddenLabel = undefined;
    }
  } else if (highlightActive === true) {
    // console.log("highlightActive was true");
    // reset all nodes
    for (let nodeId in allNodes) {
      // allNodes[nodeId].color = "purple";
      allNodes[nodeId].color = nodeColors[nodeId];
      // delete allNodes[nodeId].color;
      if (allNodes[nodeId].hiddenLabel !== undefined) {
        allNodes[nodeId].label = allNodes[nodeId].hiddenLabel;
        allNodes[nodeId].hiddenLabel = undefined;
      }
    }
    highlightActive = false;
  }

  // transform the object into an array
  var updateArray = [];
  if (params.nodes.length > 0) {
    for (let nodeId in allNodes) {
      if (allNodes.hasOwnProperty(nodeId)) {
        // console.log(allNodes[nodeId]);
        updateArray.push(allNodes[nodeId]);
      }
    }
    nodes.update(updateArray);
  } else {
    // console.log("Nothing was selected");
    for (let nodeId in allNodes) {
      if (allNodes.hasOwnProperty(nodeId)) {
        // console.log(allNodes[nodeId]);
        // allNodes[nodeId].color = {};
        updateArray.push(allNodes[nodeId]);
      }
    }
    nodes.update(updateArray);
  }
}

function filterHighlight(params) {
  allNodes = nodes.get({ returnType: "Object" });
  // if something is selected:
  if (params.nodes.length > 0) {
    filterActive = true;
    let selectedNodes = params.nodes;

    // hiding all nodes and saving the label
    for (let nodeId in allNodes) {
      allNodes[nodeId].hidden = true;
      if (allNodes[nodeId].savedLabel === undefined) {
        allNodes[nodeId].savedLabel = allNodes[nodeId].label;
        allNodes[nodeId].label = undefined;
      }
    }

    for (let i=0; i < selectedNodes.length; i++) {
      allNodes[selectedNodes[i]].hidden = false;
      if (allNodes[selectedNodes[i]].savedLabel !== undefined) {
        allNodes[selectedNodes[i]].label = allNodes[selectedNodes[i]].savedLabel;
        allNodes[selectedNodes[i]].savedLabel = undefined;
      }
    }

  } else if (filterActive === true) {
    // reset all nodes
    for (let nodeId in allNodes) {
      allNodes[nodeId].hidden = false;
      if (allNodes[nodeId].savedLabel !== undefined) {
        allNodes[nodeId].label = allNodes[nodeId].savedLabel;
        allNodes[nodeId].savedLabel = undefined;
      }
    }
    filterActive = false;
  }

  // transform the object into an array
  var updateArray = [];
  if (params.nodes.length > 0) {
    for (let nodeId in allNodes) {
      if (allNodes.hasOwnProperty(nodeId)) {
        updateArray.push(allNodes[nodeId]);
      }
    }
    nodes.update(updateArray);
  } else {
    for (let nodeId in allNodes) {
      if (allNodes.hasOwnProperty(nodeId)) {
        updateArray.push(allNodes[nodeId]);
      }
    }
    nodes.update(updateArray);
  }
}

function selectNode(nodes) {
  network.selectNodes(nodes);
  neighbourhoodHighlight({ nodes: nodes });
  return nodes;
}

function selectNodes(nodes) {
  network.selectNodes(nodes);
  filterHighlight({nodes: nodes});
  return nodes;
}

function highlightFilter(filter) {
  let selectedNodes = []
  let selectedProp = filter['property']
  if (filter['item'] === 'node') {
    let allNodes = nodes.get({ returnType: "Object" });
    for (let nodeId in allNodes) {
      if (allNodes[nodeId][selectedProp] && filter['value'].includes((allNodes[nodeId][selectedProp]).toString())) {
        selectedNodes.push(nodeId)
      }
    }
  }
  else if (filter['item'] === 'edge'){
    let allEdges = edges.get({returnType: 'object'});
    // check if the selected property exists for selected edge and select the nodes connected to the edge
    for (let edge in allEdges) {
      if (allEdges[edge][selectedProp] && filter['value'].includes((allEdges[edge][selectedProp]).toString())) {
        selectedNodes.push(allEdges[edge]['from'])
        selectedNodes.push(allEdges[edge]['to'])
      }
    }
  }
  selectNodes(selectedNodes)
}</script>
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/dist/vis-network.min.css" integrity="sha512-WgxfT5LWjfszlPHXRmBWHkV2eceiWTOBvrKCNbdgDYTHrT2AeLCGbF4sZlZw3UMN3WtL0tGUoIAKsu8mllg/XA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
            <script src="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/vis-network.min.js" integrity="sha512-LnvoEWDFrqGHlHmDD2101OrLcbsfkrzoSpvtSQtxK3RMnRV0eOkhhBN2dXHKRrUU8p2DGRTk35n4O8nWSVe1mQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
            
            
            
            
            
            

        
<center>
<h1></h1>
</center>

<!-- <link rel="stylesheet" href="../node_modules/vis/dist/vis.min.css" type="text/css" />
<script type="text/javascript" src="../node_modules/vis/dist/vis.js"> </script>-->
        <link
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
          crossorigin="anonymous"
        />
        <script
          src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
          crossorigin="anonymous"
        ></script>


        <center>
          <h1></h1>
        </center>
        <style type="text/css">

             #mynetwork {
                 width: 100%;
                 height: 800px;
                 background-color: #ffffff;
                 border: 1px solid lightgray;
                 position: relative;
                 float: left;
             }

             

             

             
        </style>
    </head>


    <body>
        <div class="card" style="width: 100%">
            
            
            <div id="mynetwork" class="card-body"></div>
        </div>

        
        

        <script type="text/javascript">

              // initialize global variables.
              var edges;
              var nodes;
              var allNodes;
              var allEdges;
              var nodeColors;
              var originalNodes;
              var network;
              var container;
              var options, data;
              var filter = {
                  item : '',
                  property : '',
                  value : []
              };

              

              

              // This method is responsible for drawing the graph, returns the drawn network
              function drawGraph() {
                  var container = document.getElementById('mynetwork');

                  

                  // parsing and collecting nodes and edges from the python
                  nodes = new vis.DataSet([{"color": "#1f77b4", "id": "e1", "label": "Articque", "shape": "dot", "size": 15, "title": "ID: e1\u003cbr\u003eType: pekg:Company\u003cbr\u003ename: Articque\u003cbr\u003eawardsAndCertifications: [\u0027Qualiopi-certified\u0027]"}, {"color": "#9467bd", "id": "e2", "label": "Professional Services", "shape": "dot", "size": 15, "title": "ID: e2\u003cbr\u003eType: pekg:ProductOrService\u003cbr\u003ename: Professional Services\u003cbr\u003edescription: Consulting services including:\n\u2022 Spatial data science expertise\n\u2022 Competitive market analysis support \u2013 to detect and display the existing competition and high potential zones\n\u2022 Site selection \u2013 to pinpoint key target locations for expansion\n\u2022 Commercial activity analysis \u2013 client churn, penetration rate, and other specific metrics\n\nSpecial projects for customized business applications:\n\u2022 Turnkey project where Articque supports the whole project from planning to final execution\n\u2022 Progressive to Total autonomy where Articque is in charge of the initial set-up of the project and assists the client in the handover"}, {"color": "#9467bd", "id": "e3", "label": "Training services", "shape": "dot", "size": 15, "title": "ID: e3\u003cbr\u003eType: pekg:ProductOrService\u003cbr\u003ename: Training services\u003cbr\u003edescription: \u25aa Training services include:\n\u2022 Analyst training \u2013 use of all basic platform features\n\u2022 Analyst advanced training \u2013 use of all advanced platform features\n\u2022 Geolocation dashboard expert training \u2013 to be able to develop interactive and dynamic geolocation dashboards\n\u2022 Wizard expert training \u2013 to be able to develop analytics and business intelligence applications serving a large scope of business needs (commercial, marketing, logistic, etc.)\n\u2022 Administrator platform training \u2013 to acquire full autonomy in the administration and management of the platform"}, {"color": "#ff7f0e", "id": "e4", "label": "Recurring Revenue (FY18A)", "shape": "dot", "size": 15, "title": "ID: e4\u003cbr\u003eType: pekg:FinancialMetric\u003cbr\u003emetricName: Recurring Revenue\u003cbr\u003evalueString: 114\u003cbr\u003efiscalPeriod: FY18A\u003cbr\u003esourceNote: Management - Billings in \u20ack"}, {"color": "#ff7f0e", "id": "e5", "label": "Non-Recurring Revenue (FY18A)", "shape": "dot", "size": 15, "title": "ID: e5\u003cbr\u003eType: pekg:FinancialMetric\u003cbr\u003emetricName: Non-Recurring Revenue\u003cbr\u003evalueString: 597\u003cbr\u003efiscalPeriod: FY18A\u003cbr\u003esourceNote: Management - Billings in \u20ack"}, {"color": "#ff7f0e", "id": "e6", "label": "Recurring Revenue (FY19A)", "shape": "dot", "size": 15, "title": "ID: e6\u003cbr\u003eType: pekg:FinancialMetric\u003cbr\u003emetricName: Recurring Revenue\u003cbr\u003evalueString: 109\u003cbr\u003efiscalPeriod: FY19A\u003cbr\u003esourceNote: Management - Billings in \u20ack"}, {"color": "#ff7f0e", "id": "e7", "label": "Non-Recurring Revenue (FY19A)", "shape": "dot", "size": 15, "title": "ID: e7\u003cbr\u003eType: pekg:FinancialMetric\u003cbr\u003emetricName: Non-Recurring Revenue\u003cbr\u003evalueString: 863\u003cbr\u003efiscalPeriod: FY19A\u003cbr\u003esourceNote: Management - Billings in \u20ack"}, {"color": "#ff7f0e", "id": "e8", "label": "Recurring Revenue (FY20A)", "shape": "dot", "size": 15, "title": "ID: e8\u003cbr\u003eType: pekg:FinancialMetric\u003cbr\u003emetricName: Recurring Revenue\u003cbr\u003evalueString: 182\u003cbr\u003efiscalPeriod: FY20A\u003cbr\u003esourceNote: Management - Billings in \u20ack"}, {"color": "#ff7f0e", "id": "e9", "label": "Non-Recurring Revenue (FY20A)", "shape": "dot", "size": 15, "title": "ID: e9\u003cbr\u003eType: pekg:FinancialMetric\u003cbr\u003emetricName: Non-Recurring Revenue\u003cbr\u003evalueString: 691\u003cbr\u003efiscalPeriod: FY20A\u003cbr\u003esourceNote: Management - Billings in \u20ack"}, {"color": "#ff7f0e", "id": "e10", "label": "Recurring Revenue (FY21A)", "shape": "dot", "size": 15, "title": "ID: e10\u003cbr\u003eType: pekg:FinancialMetric\u003cbr\u003emetricName: Recurring Revenue\u003cbr\u003evalueString: 191\u003cbr\u003efiscalPeriod: FY21A\u003cbr\u003esourceNote: Management - Billings in \u20ack"}, {"color": "#ff7f0e", "id": "e11", "label": "Non-Recurring Revenue (FY21A)", "shape": "dot", "size": 15, "title": "ID: e11\u003cbr\u003eType: pekg:FinancialMetric\u003cbr\u003emetricName: Non-Recurring Revenue\u003cbr\u003evalueString: 857\u003cbr\u003efiscalPeriod: FY21A\u003cbr\u003esourceNote: Management - Billings in \u20ack"}, {"color": "#ff7f0e", "id": "e12", "label": "Recurring Revenue (FY22L)", "shape": "dot", "size": 15, "title": "ID: e12\u003cbr\u003eType: pekg:FinancialMetric\u003cbr\u003emetricName: Recurring Revenue\u003cbr\u003evalueString: 223\u003cbr\u003efiscalPeriod: FY22L\u003cbr\u003esourceNote: Management - Billings in \u20ack"}, {"color": "#ff7f0e", "id": "e13", "label": "Non-Recurring Revenue (FY22L)", "shape": "dot", "size": 15, "title": "ID: e13\u003cbr\u003eType: pekg:FinancialMetric\u003cbr\u003emetricName: Non-Recurring Revenue\u003cbr\u003evalueString: 625\u003cbr\u003efiscalPeriod: FY22L\u003cbr\u003esourceNote: Management - Billings in \u20ack"}, {"color": "#ff7f0e", "id": "e14", "label": "Recurring CAGR (FY18A-22L)", "shape": "dot", "size": 15, "title": "ID: e14\u003cbr\u003eType: pekg:FinancialMetric\u003cbr\u003emetricName: Recurring CAGR\u003cbr\u003evalueString: +18.3%\u003cbr\u003efiscalPeriod: FY18A-22L"}, {"color": "#ffbb78", "id": "e15", "label": "Users Trained", "shape": "dot", "size": 15, "title": "ID: e15\u003cbr\u003eType: pekg:OperationalKPI\u003cbr\u003ekpiName: Users Trained\u003cbr\u003ekpiValueString: 300\u003cbr\u003ekpiDateOrPeriod: year"}, {"color": "#ffbb78", "id": "e16", "label": "Trainee Satisfaction", "shape": "dot", "size": 15, "title": "ID: e16\u003cbr\u003eType: pekg:OperationalKPI\u003cbr\u003ekpiName: Trainee Satisfaction\u003cbr\u003ekpiValueString: 17.8/20"}, {"color": "#ffbb78", "id": "e17", "label": "Trainees per session", "shape": "dot", "size": 15, "title": "ID: e17\u003cbr\u003eType: pekg:OperationalKPI\u003cbr\u003ekpiName: Trainees per session\u003cbr\u003ekpiValueString: 5"}, {"color": "#7f7f7f", "id": "e18", "label": "DDA \u0026 Company France SAS", "shape": "dot", "size": 15, "title": "ID: e18\u003cbr\u003eType: pekg:Advisor\u003cbr\u003ename: DDA \u0026 Company France SAS"}, {"color": "#7f7f7f", "id": "e19", "label": "ChapsVision", "shape": "dot", "size": 15, "title": "ID: e19\u003cbr\u003eType: pekg:Advisor\u003cbr\u003ename: ChapsVision"}]);
                  edges = new vis.DataSet([{"arrows": "to", "from": "e1", "label": "offers", "title": "pekg:offers", "to": "e2"}, {"arrows": "to", "from": "e1", "label": "offers", "title": "pekg:offers", "to": "e3"}, {"arrows": "to", "from": "e1", "label": "reportsFinancialMetric", "title": "pekg:reportsFinancialMetric", "to": "e4"}, {"arrows": "to", "from": "e1", "label": "reportsFinancialMetric", "title": "pekg:reportsFinancialMetric", "to": "e5"}, {"arrows": "to", "from": "e1", "label": "reportsFinancialMetric", "title": "pekg:reportsFinancialMetric", "to": "e6"}, {"arrows": "to", "from": "e1", "label": "reportsFinancialMetric", "title": "pekg:reportsFinancialMetric", "to": "e7"}, {"arrows": "to", "from": "e1", "label": "reportsFinancialMetric", "title": "pekg:reportsFinancialMetric", "to": "e8"}, {"arrows": "to", "from": "e1", "label": "reportsFinancialMetric", "title": "pekg:reportsFinancialMetric", "to": "e9"}, {"arrows": "to", "from": "e1", "label": "reportsFinancialMetric", "title": "pekg:reportsFinancialMetric", "to": "e10"}, {"arrows": "to", "from": "e1", "label": "reportsFinancialMetric", "title": "pekg:reportsFinancialMetric", "to": "e11"}, {"arrows": "to", "from": "e1", "label": "reportsFinancialMetric", "title": "pekg:reportsFinancialMetric", "to": "e12"}, {"arrows": "to", "from": "e1", "label": "reportsFinancialMetric", "title": "pekg:reportsFinancialMetric", "to": "e13"}, {"arrows": "to", "from": "e1", "label": "reportsFinancialMetric", "title": "pekg:reportsFinancialMetric", "to": "e14"}, {"arrows": "to", "from": "e1", "label": "reportsOperationalKPI", "title": "pekg:reportsOperationalKPI", "to": "e15"}, {"arrows": "to", "from": "e1", "label": "reportsOperationalKPI", "title": "pekg:reportsOperationalKPI", "to": "e16"}, {"arrows": "to", "from": "e1", "label": "reportsOperationalKPI", "title": "pekg:reportsOperationalKPI", "to": "e17"}, {"arrows": "to", "from": "e1", "label": "advisedBy", "title": "pekg:advisedBy", "to": "e18"}, {"arrows": "to", "from": "e1", "label": "advisedBy", "title": "pekg:advisedBy", "to": "e19"}]);

                  nodeColors = {};
                  allNodes = nodes.get({ returnType: "Object" });
                  for (nodeId in allNodes) {
                    nodeColors[nodeId] = allNodes[nodeId].color;
                  }
                  allEdges = edges.get({ returnType: "Object" });
                  // adding nodes and edges to the graph
                  data = {nodes: nodes, edges: edges};

                  var options = {"nodes": {"shape": "dot", "size": 18, "font": {"size": 14, "face": "Tahoma"}}, "edges": {"arrows": {"to": {"enabled": true, "scaleFactor": 0.7}}, "color": {"inherit": "from"}, "smooth": {"type": "continuous", "roundness": 0.2}, "font": {"size": 10, "align": "middle"}}, "physics": {"enabled": true, "barnesHut": {"gravitationalConstant": -30000, "centralGravity": 0.3, "springLength": 250, "springConstant": 0.04, "damping": 0.09}, "minVelocity": 0.75}, "interaction": {"hover": true, "tooltipDelay": 200, "multiselect": true}, "layout": {"hierarchical": false}};

                  


                  

                  network = new vis.Network(container, data, options);

                  

                  

                  


                  

                  return network;

              }
              drawGraph();
        </script>
    </body>
</html>